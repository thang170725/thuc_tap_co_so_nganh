{% extends 'base.html' %}
{% load static %}

{% block title %}{{ form_title }}{% endblock title %}

<!-- 1. CSS cho Tab Navigation -->
{% block page_css %}
<style>
    .sub-nav { display: flex; background-color: #f8f9fa; border-radius: 5px; margin-bottom: 20px; }
    .sub-nav a { padding: 12px 20px; text-decoration: none; color: #555; font-weight: bold; border-bottom: 3px solid transparent; }
    .sub-nav a.active, .sub-nav a:hover { color: #007bff; border-bottom-color: #007bff; }
</style>
{% endblock %}

<!-- 2. Lấp đầy sidebar của Admin -->
{% block role_specific_links %}
    <div>
        <ul class="main-menu">
            <li><i class="fa-solid fa-people-group"></i>Thông tin
                <ul class="child-menu">
                    <li><a href="{% url 'admin_teacher_infor' %}" class="nav-item">Thông tin giảng viên</a></li>
                    <li><a href="{% url 'admin_student_infor' %}" class="nav-item">Thông tin sinh viên</a></li>
                </ul>
            </li>
        </ul>
    </div>  
    <a href="{% url 'event_management' %}" class="nav-item"><i class="fas fa-calendar-check"></i> Quản lý Sự kiện</a>
    <a href="{% url 'user_list' %}" class="nav-item"><i class="fas fa-users-cog"></i> Quản lý Người dùng</a>
    <a href="{% url 'course_list' %}" class="nav-item"><i class="fas fa-book-open"></i> Quản lý Học vụ</a>
    <!-- Đánh dấu active cho link Quản lý Xếp lịch -->
    <a href="{% url 'room_list' %}" class="nav-item active"><i class="fas fa-calendar-alt"></i> Quản lý Xếp lịch</a>
{% endblock role_specific_links %}

<!-- 3. Chèn thông tin User Admin -->
{% block user_info %}
    <div class="get-username">
        Xin chào, {{ user_profile.userId }}<br> 
        <span style="font-size: 16px;">Admin</span>
    </div>
{% endblock user_info %}

<!-- 4. Nội dung chính -->
{% block content %}
<div style="padding: 20px; background-color: white; margin: 20px; border-radius: 8px;">
    
    <h2 style="border-bottom: 2px solid #eee; padding-bottom: 10px;">Quản lý Xếp lịch</h2>
    
    <!-- Thanh Tab Navigation (Phòng học / Xếp lịch) -->
    <div class="sub-nav">
        <a href="{% url 'room_list' %}">Quản lý Phòng học</a>
        <a href="{% url 'schedule_list' %}" class="active">Xếp lịch TKB</a>
    </div>

    <h3 style="margin-top: 20px;">{{ form_title }}</h3>

    <!-- (Hiển thị messages (nếu có)) -->
    {% if messages %}
        {% for message in messages %}
            {% if message.tags == 'error' %}
            <div style="padding: 15px; margin: 20px 0; border-radius: 5px; background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;">
                {{ message }}
            </div>
            {% endif %}
        {% endfor %}
    {% endif %}
    
    <!-- Hiển thị lỗi Form (trùng lịch) -->
    {% if form.non_field_errors %}
        <div style="padding: 15px; margin: 20px 0; border-radius: 5px; background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;">
            {{ form.non_field_errors }}
        </div>
    {% endif %}
    {% for field in form %}
        {% if field.errors %}
        <div style="padding: 15px; margin: 20px 0; border-radius: 5px; background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;">
            <strong>Lỗi ở trường {{ field.label }}:</strong> {{ field.errors.0 }}
        </div>
        {% endif %}
    {% endfor %}

    <form method="POST" class="schedule-form" style="margin-top: 20px;">
        {% csrf_token %}
        
        <!-- Render các trường của form (as_p) -->
        {{ form.as_p }}
        
        <style>
            .schedule-form p { margin-bottom: 15px; }
            .schedule-form p label { display: block; margin-bottom: 5px; font-weight: bold; }
            .schedule-form p input, .schedule-form p select {
                width: 95%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;
            }
        </style>

        <button type="submit" style="padding: 10px 15px; background-color: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px;">
            Lưu Lịch học
        </button>
        <a href="{% url 'schedule_list' %}" style="padding: 10px 15px; background-color: #6c757d; color: white; border: none; border-radius: 5px; text-decoration: none; margin-left: 10px; font-size: 16px;">
            Hủy bỏ
        </a>
    </form>
</div>
{% endblock content %}